'use strict';
let an={};let ao={};let ap={};let aq=false;let ar=null;let as=1024;let at="TMK-menu-";const TMK_FLOATING_MENU=1;const TMK_POPUP_MENU=2;const TMK_MENU_VERTICAL=1;const TMK_MENU_HORIZONTAL=2;const TMK_MENU_ACTIVE=1;const TMK_MENU_PASSIVE=2;function TMK_menu(args){let menu;let direction;let menu_type;let active;if(arguments.length==0 || typeof args!="object")return;if(menu=args["menu"]){if(Array.isArray(menu)){if(menu.length> 0)menu=menu[0];else return;}direction=menu["direction"] ?(menu["direction"]==TMK_MENU_HORIZONTAL  ? TMK_MENU_HORIZONTAL:TMK_MENU_VERTICAL):TMK_MENU_VERTICAL;menu_type=menu["type"]      ?(menu["type"]==TMK_FLOATING_MENU    ? TMK_FLOATING_MENU:TMK_POPUP_MENU):TMK_POPUP_MENU;active=menu["active"]    ?(menu["active"]==TMK_MENU_PASSIVE     ? TMK_MENU_PASSIVE:TMK_MENU_ACTIVE):TMK_MENU_ACTIVE;return aa(args,null,null,0,menu_type,direction,active);}}function aa(args,parent_id,menu_id,level,menu_type,direction,active){let i;let id;let obj;let func;let count;let items;let coords;let zindex;let defaults;let overrides;let menu_item;let window_id;let background;let top_zindex;if(arguments.length==0)return;window_id=null;if(args["menu"]){if(!menu_id)menu_id=TMK_make_random_id();overrides={};defaults={};if(args["menu"]["header"])overrides["header"]=args["menu"]["header"];if(menu_type==TMK_POPUP_MENU)overrides["resize"]=false;overrides["onmove"]=ae;overrides["onresize"]=ae;overrides["onminimize"]=function(window_id,menu_id){ak(null,menu_id,0)},overrides["style"]=(menu_type==TMK_POPUP_MENU)? "none":args["style"];overrides["display"]=(level==0)? true:false;overrides["html"]=ab(args,parent_id,menu_id,level,menu_type,direction,active);overrides["type"]="menu";overrides["inactive"]=true;if(level> 0){id=am(menu_id,0,0);if(menu_item=document.getElementById(id)){window_id=menu_item.dataset.window_id;zindex=TMK_get_window_zindex(window_id);if((top_zindex=TMK_top_zindex())> zindex)zindex=top_zindex+100;overrides["zindex"]=zindex;for(i=0;i< level;i++){id=am(menu_id,i,0);if(menu_item=document.getElementById(id))TMK_set_window_zindex(menu_item.dataset.window_id,zindex);}}}window_id=TMK_window_open(TMK_make_window_args(args,overrides,defaults,null,ar));TMK_set_private_window_arg(window_id,"menu_id",menu_id);if(obj=TMK_get_window_obj(window_id))obj.classList.add("fadein-fast");background=null;if(level==1 ||(level==0 && menu_type==TMK_POPUP_MENU)){let zindex;id=am(menu_id,0,0);if(menu_item=document.getElementById(id)){if(level==0)id=window_id;else id=(menu_item.dataset.type==TMK_POPUP_MENU)? null:menu_item.dataset.window_id;if(id){if(zindex=TMK_get_window_zindex(id)){if(background=TMK_background(window_id,zindex - 10,function(event){ak(event,menu_id,0)}))document.body.insertBefore(background,null);}}}}items=args["menu"]["items"];count=items.length;for(i=0;i< count;i++){id=am(menu_id,level,i);if(menu_item=document.getElementById(id)){menu_item.dataset.window_id=window_id;coords=TMK_get_window_position(window_id);menu_item.dataset.x=coords["x"];menu_item.dataset.y=coords["y"];menu_item.dataset.w=coords["w"];menu_item.dataset.h=coords["h"];if(background)menu_item.dataset.background=background.id;if(menu_item.dataset.enabled!="disabled"){ap[id]=items[i]["arg"];if(func=items[i]["onclick"]){ao[id]=func;menu_item.addEventListener("click",function(event){aj(event,this)});}menu_item.addEventListener("mouseenter",function(event){ah(event,this,args)});if(an[id]){let event_name;event_name=(active==TMK_MENU_ACTIVE)? "mouseenter":"click";menu_item.addEventListener(event_name,function(event){af(event,this,args)});}}}}}return menu_id;}function TMK_menu_get_window_id(menu_id){let id;let ret;let menu_item;ret=null;id=am(menu_id,0,0);if(menu_item=document.getElementById(id))ret=menu_item.dataset.window_id;return ret;}function ab(args,parent_id,menu_id,level,menu_type,direction,active){let i;let id;let off;let uid;let html;let func;let icon;let text;let count;let enabled;let menu_item;html="";if(direction==TMK_MENU_HORIZONTAL)html="<table width=100% height=100% cellpadding=0 cellspacing=0 border=0><tr>";count=args["menu"]["items"].length;off=0;for(i=0;i< count;i++){menu_item=null;enabled=args["menu"]["items"][i]["state"] ? args["menu"]["items"][i]["state"]:"enabled";if(enabled=="hidden")continue;id=am(menu_id,level,i);text=args["menu"]["items"][i]["text"];icon=args["menu"]["items"][i]["icon"];if(text || icon){let menu;let click;menu=args["menu"]["items"][i]["menu"]  ? true:false;click=args["menu"]["items"][i]["onclick"] ? true:false;func=args["menu"]["items"][i]["menufunc"] ? true:false;if(!(menu || click || func))enabled="header";html+="<td><div  id="+id+" class='";if(direction==TMK_MENU_HORIZONTAL)html+="TMK-horizontal-menu-item-"+enabled;else html+="TMK-vertical-menu-item-"+enabled;if(args["zebra"]){if((parseInt(off / 2)* 2)==off)html+=" TMK-zebra";}html+="'";html+=" data-menu_id="+menu_id;html+=" data-count="+count;html+=" data-level="+level;html+=" data-direction="+direction;html+=" data-active="+active;html+=" data-engaged="+false;html+=" data-parent="+parent_id;html+=" data-state="+"closed";html+=" data-type="+menu_type;html+=" data-enabled="+enabled;if(uid=args["menu"]["items"][i]["id"])html+=" data-uid="+uid;html+=">";if(args["menu"]["items"][i]["menu"] || args["menu"]["items"][i]["menufunc"]){if(direction==TMK_MENU_HORIZONTAL)html+=ac(icon,text,args["menu"]["icon_axis"]);else{html+="<table cellpadding=0 cellspacing=0 width=100%><tr>";html+="<td>"+text+"</td><td width=12><small>&nbsp;&#x25BA</small></td>";html+="</tr></table>";}if(args["menu"]["items"][i]["menu"])an[id]=args["menu"]["items"][i]["menu"];else an[id]=args["menu"]["items"][i]["menufunc"];}else html+=ac(icon,text);html+="</div>";if(direction==TMK_MENU_HORIZONTAL)html+="</td>";off++;}else{if(direction==TMK_MENU_HORIZONTAL)html+="<td><div class=TMK-menu-horizontal-separator id="+id+">&nbsp;</td>";else{html+="<div class=TMK-menu-vertical-separator-top></div>";html+="<div class=TMK-menu-vertical-separator-bottom></div>";}}}if(direction==TMK_MENU_HORIZONTAL)html+="</tr></table>";return html;}function ac(icon,text,axis){let ret;if(icon){ret="";ret+="<div style='display:flex;align-items:center;'>";if(axis==TMK_AXIS_RIGHT){ret+="<span>"+text+"&nbsp;&nbsp;</span>";ret+="<img class=TMK-menu-item-icon src=\""+icon+"\">";}else{ret+="<img class=TMK-menu-item-icon src=\""+icon+"\">";ret+="<span>&nbsp;&nbsp;"+text+"</span>";}ret+="</div>";}else ret=text;return ret;}function ae(window_id,arg,new_coords){let i;let id;let obj;let count;let level;let coords;let menu_id;let old_coords;menu_id=TMK_get_private_window_arg(window_id,"menu_id");TMK_console_log("ae:"+window_id+" menu_id="+menu_id);id=am(menu_id,0,0);if(obj=document.getElementById(id)){old_coords={};old_coords["x"]=parseInt(obj.dataset.x);old_coords["y"]=parseInt(obj.dataset.y);old_coords["w"]=parseInt(obj.dataset.w);old_coords["h"]=parseInt(obj.dataset.h);count=parseInt(obj.dataset.count);for(i=0;i< count;i++){id=am(menu_id,0,i);if(obj=document.getElementById(id)){obj.dataset.x=new_coords["x"];obj.dataset.y=new_coords["y"];obj.dataset.w=new_coords["w"];obj.dataset.h=new_coords["h"];}}for(level=1;level< as;level++){id=am(menu_id,level,0);if(obj=document.getElementById(id)){coords={};coords["x"]=parseInt(obj.dataset.x)+new_coords["x"] - old_coords["x"]+new_coords["w"] - old_coords["w"];coords["y"]=parseInt(obj.dataset.y)+new_coords["y"] - old_coords["y"];obj.dataset.x=coords["x"];obj.dataset.y=coords["y"];coords["w"]=parseInt(obj.dataset.w);coords["h"]=parseInt(obj.dataset.h);TMK_set_window_position(obj.dataset.window_id,coords);}else break;}}}function af(e,menu_item,args){let x;let y;let w;let h;let hh;let id;let ewb;let rect;let style;let nargs;let level;let coords;let header;let content;let menu_id;level=parseInt(menu_item.dataset.level);if(menu_item.dataset.state=="closed"){nargs=dup_args(args);rect=menu_item.getBoundingClientRect();x=rect.left;y=rect.top;style=window.getComputedStyle(TMK_get_window_obj(menu_item.dataset.window_id));if(menu_item.dataset.direction==TMK_MENU_HORIZONTAL){ewb=parseInt(style.getPropertyValue("border-bottom-width").replace("px",""));h=rect.height;nargs["x"]=x;nargs["y"]=y+h+ewb;}else{ewb=parseInt(style.getPropertyValue("border-right-width").replace("px",""));coords=TMK_get_window_position(menu_item.dataset.window_id);w=coords["w"];nargs["x"]=x+w+ewb;nargs["y"]=y;}if(typeof an[menu_item.id]=="function")nargs["menu"]=an[menu_item.id](menu_item,ap[menu_item.id]);else nargs["menu"]=an[menu_item.id];nargs["header"]=null;delete nargs["max_h"];delete nargs["max_w"];delete nargs["min_h"];delete nargs["min_w"];delete nargs["fit"];menu_id=aa(nargs,menu_item.id,menu_item.dataset.menu_id,level+1,TMK_POPUP_MENU,TMK_MENU_VERTICAL,TMK_MENU_ACTIVE);menu_item.dataset.state="open";ag(menu_id,level+1,menu_item);aq=true;}}function ag(menu_id,level,parent){let x;let y;let id;let menu;let rect;let coord;id=am(menu_id,level,0);rect=parent.getBoundingClientRect();if(menu=document.getElementById(id)){if(coord=TMK_get_window_position(menu.dataset.window_id)){if(coord["y"]+coord["h"]> window.innerHeight){if(parent.dataset.direction==TMK_MENU_HORIZONTAL)y=rect.top - coord["h"];else y=rect.top+rect.height - coord["h"];if(y< 0)y=0;TMK_set_window_position(menu.dataset.window_id,{y:y});}if(coord["x"]+coord["w"]> window.innerWidth){if(parent.dataset.direction==TMK_MENU_HORIZONTAL)x=window.innerWidth - coord["w"] - 2;else x=rect.left - coord["w"] - 2;if(x< 0)x=0;TMK_set_window_position(menu.dataset.window_id,{x:x});}TMK_window_display(menu.dataset.window_id,true);}}}function ah(e,menu_item,args){let i;let id;let obj;let count;let level;if(menu_item.dataset.state=="closed"){level=parseInt(menu_item.dataset.level);if(aq){ak(null,menu_item.dataset.menu_id,level+1);af(e,menu_item,args);}else{count=parseInt(menu_item.dataset.count);TMK_window_raise(menu_item.dataset.window_id);for(i=0;i< count;i++){id=am(menu_item.dataset.menu_id,level,i);if(obj=document.getElementById(id)){if(obj.dataset.state=="open"){ak(null,menu_item.dataset.menu_id,level+1);obj.dataset.state="closed";}}}}}}function aj(event,menu_item){let func;let level;if(func=ao[menu_item.id]){if(typeof func=="function")func(event,menu_item,ap[menu_item.id]);else if(typeof func=="string")eval(func);if(menu_item.dataset.type==TMK_POPUP_MENU)ak(null,menu_item.dataset.menu_id,0);}}function ak(e,menu_id,level){let i;let id;let obj;let count;let menu_item;if(e)e.preventDefault();if(level==0)aq=false;for(;level< as;level++){id=am(menu_id,level,0);if(menu_item=document.getElementById(id)){if(menu_item.dataset.type==TMK_POPUP_MENU){if(menu_item.dataset.background){if(obj=document.getElementById(menu_item.dataset.background))obj.remove();}TMK_window_close(menu_item.dataset.window_id);if(obj=document.getElementById(menu_item.dataset.parent))obj.dataset.state="closed";}count=parseInt(menu_item.dataset.count);if(menu_item.dataset.type==TMK_POPUP_MENU){for(i=0;i< count;i++){id=am(menu_id,level,i);if(an[id])delete an[id];if(ao[id])delete ao[id];if(ap[id])delete ap[id];}}}else break;}}function TMK_set_menu_item_icon(menu,item_id,icon){return al(menu,item_id,"icon",icon);}function TMK_menu_item_enable(menu,item_id){return al(menu,item_id,"state","enabled");}function TMK_menu_item_disable(menu,item_id){return al(menu,item_id,"state","disabled");}function TMK_menu_item_show(menu,item_id){return al(menu,item_id,"state","enabled");}function TMK_menu_item_hide(menu,item_id){return al(menu,item_id,"state","hidden");}function TMK_menu_item_arg(menu,item_id,arg){return al(menu,item_id,"arg",arg);}function TMK_menu_item_add_after(menu,after_id,entry){let i;let count;if(menu && menu["items"]){count=menu["items"].length;for(i=0;i< count;i++){if(after_id==menu["items"][i]["id"]){menu["items"].splice(i,0,entry);break;}}}}function al(menu,item_id,key,val){let i;let id;let ret;let level;let count;let menu_item;ret=null;if(menu && menu["items"]){count=menu["items"].length;for(i=0;i< count;i++){if(item_id==menu["items"][i]["id"]){menu["items"][i][key]=val;ret=val;break;}if(menu["items"][i]["menu"])al(menu["items"][i]["menu"],item_id,key,val);}}return ret;}function am(menu_id,level,item){return  at+menu_id+"-"+level+"-"+item;}function TMK_set_menu_args(args){ar=dup_args(args);}let au=null;const TMK_CONSOLE_ID="TMK-console";function TMK_console_open(args){let ret;let func;let html;let defaults;let overrides;if(au!=null)return;if(arguments.length==0)args="";if(typeof args!="object")args={html:args.toString(),shadow:true,};html="<div style='padding:5px' id="+TMK_CONSOLE_ID+" data-tstamp="+(args["tstamp"] ? 1:0)+">";if(args["html"])html+=TMK_text_to_html(args["html"]);html+="</div>";overrides={};defaults={};overrides["html"]=html;overrides["keyboard"]=false;defaults["exclusive"]=false;defaults["resize"]=true;defaults["dragable"]=true;defaults["shadow"]=true;defaults["style"]="auto";defaults["w"]=400;defaults["min_w"]=200;defaults["min_h"]=100;defaults["header"]="Console";defaults["box"]=TMK_DIMS_WINDOW;if(func=args["onclose"])overrides["onclose"]=function(){func(args["arg"]);au=null;};else defaults["onclose"]=function(){au=null};return au=TMK_window_open(TMK_make_window_args(args,overrides,defaults,null,null));}function TMK_console_log(msg){let obj;let rect;let content;let tstamp;let date;if(obj=document.getElementById(TMK_CONSOLE_ID)){if(arguments.length==0)args="";else if(typeof msg!="string")msg=msg.toString();tstamp="";if(parseInt(obj.dataset.tstamp)){date=new Date();tstamp=date.toUTCString()+":";}obj.innerHTML+=tstamp+TMK_text_to_html(msg)+"<br>";if(content=TMK_get_content_obj(au)){rect=content.getBoundingClientRect();if(rect.height< content.scrollHeight)content.scrollTop=(content.scrollHeight - rect.height);}}}function TMK_console_clear(){let obj;if(obj=document.getElementById(TMK_CONSOLE_ID))obj.innerHTML="";}function TMK_console_close(){if(au){TMK_window_close(au);au=null;}}function TMK_console_download(){let obj;let text;let filename;if(text=TMK_console_get()){filename="console.txt";obj=document.createElement('a');obj.setAttribute('href','data:text/plain;charset=utf-8,'+encodeURIComponent(text));obj.setAttribute('download',filename);obj.style.display='none';document.body.appendChild(obj);obj.click();document.body.removeChild(obj);}}function TMK_console_get(){let obj;let ret;ret=null;if(au){if(obj=document.getElementById(TMK_CONSOLE_ID)){ret=obj.innerHTML;ret=ret.replaceAll("&nbsp;"," ");ret=ret.replaceAll("&lt;","<");ret=ret.replaceAll("&gt;",">");ret=ret.replaceAll("<br>","\n");}}return ret;}let bj={};let bk=null;let bl={};let bm={};let bn=48;let bo=12;let bp=72;let bq=72;let br=15;function TMK_icon(args){let x;let y;let h;let w;let id;let obj;let axis;let icon;let html;let text;let x_off;let y_off;let active;let text_x;let text_w;let icon_id;let defaults;let noborder;let launchpad;let overrides;let tag_class;let window_id1;let window_id2;let launchpad_id;w=args["w"];h=args["h"];if(!w && !h){w=bn;h=bn;}else if(w && !h)h=w;else if(h && !w)w=h;icon_id=TMK_make_random_id();html="";noborder=false;overrides={};defaults={};if(args["icon"]){html="<img style='display:block;' width="+w+" height="+h+" src=\""+args["icon"]+"\">";noborder=true;overrides["bcolor"]="rgba(255,255,255,0.00)";}else if(args["tag"]){tag_class="TMK-icon-tag";switch(w){case 32:tag_class="TMK-icon-tag-32";break;case 48:tag_class="TMK-icon-tag-48";break;case 64:tag_class="TMK-icon-tag-64";break;case 96:tag_class="TMK-icon-tag-96";break;}html="<div class="+tag_class+">"+args["tag"].substring(0,1)+"</div>";defaults["bcolor"]="rgba(255,255,255,1.00)";}overrides["html"]=html;overrides["header"]=null;overrides["onmove"]=bg;overrides["onmoved"]=bf;overrides["arg"]=icon_id;overrides["w"]=w;overrides["h"]=h;overrides["zindex"]=500;overrides["type"]="icon";overrides["inactive"]=true;defaults["radius"]=12;defaults["noborder"]=noborder;launchpad=null;axis=null;if(launchpad_id=args["launchpad"]){if(launchpad=bm[launchpad_id]){let i;let id;if(!(axis=launchpad["axis"]))axis=TMK_AXIS_BOTTOM;x_off=bo;y_off=bo;for(i=0;i< launchpad["icons"].length;i++){id=launchpad["icons"][i];if(icon=bj[id]){switch(axis){case TMK_AXIS_TOP:case TMK_AXIS_BOTTOM:default:x_off+=icon["w"]+bo;break;case TMK_AXIS_LEFT:case TMK_AXIS_RIGHT:y_off+=icon["h"]+2+bo;x_off=(launchpad["w"] - icon["w"])/ 2;break;}}}overrides["x"]=x_off;overrides["y"]=y_off;overrides["parent"]=launchpad_id;}}active=args["active"];window_id1=TMK_window_open(TMK_make_window_args(args,overrides,defaults,null,bk));window_id2=null;if(obj=TMK_get_content_obj(window_id1)){let pos;aw(obj,window_id1,icon_id,launchpad_id,args);if((text=args["text"])|| launchpad){let foo;pos=TMK_get_window_position(window_id1);text_w=w;window_id2=TMK_make_random_id();if(launchpad){foo=8;html="<div id=TMK-icon-text"+window_id2+" class=\"TMK-icon-text ";if(active)html+=" TMK-icon-active\">";else html+=" TMK-icon-inactive\">";y_off+=pos["h"]+4;}else{text_x=pos["x"];html="<div class=TMK-icon-text style='text-align:center;'>";text_w=w+(br * 2);text_x -=br;html+=TMK_text_to_html(text);foo=8;x_off=text_x;y_off=pos["y"]+pos["h"]+2;}html+="</div>";TMK_window_open({window_id:window_id2,html:html,x:x_off+foo,y:y_off,w:text_w -(foo * 2),max_h:30,zindex:500,max_h:30,max_w:text_w,inactive:true,overflow:"wrap",noborder:true,bcolor:"rgba(255,255,255,0.00)",radius:0,parent:launchpad_id,overflow:"none",});if(obj=TMK_get_content_obj(window_id2))aw(obj,window_id2,icon_id,launchpad_id,args);if(obj=TMK_get_content_obj(window_id1)){if(launchpad && text){obj.addEventListener("mouseenter",function(){av(event,icon_id,text,true)});obj.addEventListener("mouseleave",function(){av(event,icon_id,text,false)});}}}}icon={icon_id:icon_id,x:x,y:y,w:w,h:h,hover:null,image:window_id1,text:window_id2,onmove:args["onmove"],arg:args["arg"],func:args["onclick"],launchpad:launchpad_id,};if(launchpad)launchpad["icons"].push(icon_id);bj[icon_id]=icon;return icon_id;}function av(e,icon_id,text,show){let x;let y;let id;let pos;let html;let pos2;let icon;let icon_image_id;let launchpad_id;if(icon=bj[icon_id]){if(show){if(!icon["hover"]){if(launchpad_id=icon["launchpad"]){let launchpad;if(launchpad=bm[launchpad_id]){if(icon_image_id=icon["image"]){pos=TMK_get_window_position(icon_image_id);switch(launchpad["axis"]){case TMK_AXIS_LEFT:x=launchpad["x"]+pos["x"]+pos["w"]+8;y=launchpad["y"]+pos["y"];break;case TMK_AXIS_BOTTOM:x=launchpad["x"]+pos["x"]+(pos["w"] / 2);y=window.innerHeight -(launchpad["y"]+pos["y"]+pos["h"]+42);break;case TMK_AXIS_TOP:x=launchpad["x"]+pos["x"]+(pos["w"] / 2);y=launchpad["y"]+pos["y"]+pos["h"]+16;break;case TMK_AXIS_RIGHT:x=0;y=launchpad["y"]+pos["y"]+(pos["h"] / 2);break;}html="<div class=TMK-icon-hover>"+text+"</div>";icon["hover"]=TMK_window_open({x:x,y:y,shadow:true,inactive:true,html:html,});switch(launchpad["axis"]){case TMK_AXIS_LEFT:pos2=TMK_get_window_position(icon["hover"]);y+=(pos["h"] - pos2["h"])/ 2;TMK_set_window_position(icon["hover"],{y:y});break;case TMK_AXIS_RIGHT:pos2=TMK_get_window_position(icon["hover"]);x=window.innerWidth - pos["w"] - pos2["w"] - 24;y=pos2["y"] -(pos2["h"] / 2);TMK_set_window_position(icon["hover"],{x:x,y:y});break;}}}}}}else{if(id=icon["hover"]){TMK_window_close(id);icon["hover"]=null;}}}}function aw(icon,icon_image_id,icon_id,launchpad_id,args){if(args["dragable"])icon.addEventListener("mousedown",function(){TMK_start_mouse_move(event,icon_image_id)});icon.addEventListener("dblclick",function(){bh(event,icon_id)});if(args["open"]){icon.addEventListener("contextmenu",function(){ax(event,this,icon_image_id,launchpad_id,args["active"],args["open"],false)});icon.addEventListener("dblclick",function(){ax(event,this,icon_image_id,launchpad_id,args["active"],args["open"],true)});}else{if(args["menu"])icon.addEventListener("contextmenu",function(){be(event,this,id,args["onclick"],args["menu"])});}}function ax(e,icon_obj,icon_image_id,launchpad_id,active,openfunc,launch){let x;let y;let id;let arg;let menu;let data;e.preventDefault();menu=null;if(data=bl[icon_image_id])menu=data["menu"];if(menu==null){menu={direction:TMK_MENU_VERTICAL,type:TMK_POPUP_MENU,items:[{id:1,text:"<small>Open</small>",arg:null,onclick:function(e,obj,arg){ay(arg)},},{id:2,text:"<small>Close</small>",arg:null,onclick:function(e,obj,arg){ba(arg)},state:"disabled",},{id:3,text:"<small>Minimize</small>",arg:null,onclick:function(e,obj,arg){bc(arg)},state:"disabled",},{id:4,text:"<small>Expand</small>",arg:null,onclick:function(e,obj,arg){bc(arg)},state:"hidden",},],};bl[icon_image_id]={id:icon_image_id,menu:menu,window:active};if(active){TMK_menu_item_enable(menu,2);TMK_menu_item_enable(menu,3);TMK_menu_item_arg(menu,2,icon_image_id);TMK_menu_item_arg(menu,3,icon_image_id);TMK_menu_item_arg(menu,4,icon_image_id);TMK_menu_item_disable(menu,1);bl[icon_image_id]["static"]=false;}else bl[icon_image_id]["static"]=true;bl[icon_image_id]["launchpad"]=launchpad_id;}else{}x=e.clientX+4;y=e.clientY - 6;arg=TMK_menu_item_arg(menu,1,{menu:menu,func:openfunc,icon_image_id:icon_image_id,launchpad:launchpad_id});if(launch)ay(arg);else{TMK_menu({x:x,y:y,fit:true,menu:menu,});}}function ay(arg){let id;let obj;let key;let wid;let data;let menu;let func;menu=arg["menu"];func=arg["func"];wid=arg["icon_image_id"];if(data=bl[wid]){if(!data["window"]){id=func(az,bb,arg["launchpad"],wid);if(obj=TMK_get_window_obj(id))obj.classList.add("fadein");if(data=bl[wid])data["window"]=id;}else{TMK_window_raise(data["window"]);TMK_window_unminimize(data["window"]);}TMK_menu_item_disable(menu,1);TMK_menu_item_enable(menu,2);TMK_menu_item_enable(menu,3);TMK_menu_item_arg(menu,2,wid);TMK_menu_item_arg(menu,3,wid);TMK_menu_item_arg(menu,4,wid);for(key in bj){if(bj[key]["image"]==wid){if(obj=document.getElementById("TMK-icon-text"+bj[key]["text"])){obj.classList.remove("TMK-icon-inactive");obj.classList.add("TMK-icon-active");}break;}}}}function az(window_id,arg,pos){let key;let obj;let data;let func;let menu;let win;let icon;if(win=TMK_windows[window_id])icon=win["icon"];if(data=bl[icon]){data["window"]=null;menu=data["menu"];TMK_menu_item_enable(menu,1);TMK_menu_item_disable(menu,2);TMK_menu_item_disable(menu,3);if(func=TMK_get_private_window_arg(window_id,"onclose"))func(window_id,data["arg"],pos);if(data["static"]){for(key in bj){if(bj[key]["image"]==icon){if(obj=document.getElementById("TMK-icon-text"+bj[key]["text"])){obj.classList.remove("TMK-icon-active");obj.classList.add("TMK-icon-inactive");}break;}}}else{for(key in bj){if(bj[key]["image"]==icon){let i;let text_id;let image_id;image_id=bj[key]["image"];text_id=bj[key]["text"];if(obj=TMK_get_window_obj(image_id))obj.classList.add("fadeout");if(obj=TMK_get_window_obj(text_id))obj.classList.add("fadeout");setTimeout( function(){TMK_window_close(image_id);TMK_window_close(text_id);TMK_launchpad_reposition(data["launchpad"]);},250);for(i=0;i< bm[data["launchpad"]]["icons"].length;i++){if(bm[data["launchpad"]]["icons"][i]==key){bm[data["launchpad"]]["icons"].splice(i,1);break;}}delete bj[key];break;}}}}}function TMK_launchpad_reposition(launchpad_id){let i;let id;let pos;let axis;let icon;let x_off;let y_off;let delta_x;let delta_y;let launchpad;if(launchpad=bm[launchpad_id]){x_off=0;y_off=0;x_off=bo;y_off=bo;axis=launchpad["axis"];for(i=0;i< launchpad["icons"].length;i++){id=launchpad["icons"][i];if(icon=bj[id]){pos=TMK_get_window_position(icon["image"]);delta_x=x_off - pos["x"];delta_y=y_off - pos["y"];if(Math.abs(delta_x)> 5 || Math.abs(delta_y)> 5){let fx;let fy;TMK_slide_div(icon["image"],pos["x"],pos["y"],pos["x"]+delta_x,pos["y"]+delta_y,0.3,true);pos=TMK_get_window_position(icon["text"]);TMK_slide_div(icon["text"],pos["x"],pos["y"],pos["x"]+delta_x,pos["y"]+delta_y,0.3,true);}switch(axis){case TMK_AXIS_BOTTOM:x_off+=icon["w"]+bo;break;case TMK_AXIS_TOP:default:x_off+=icon["w"]+bo;break;case TMK_AXIS_LEFT:case TMK_AXIS_RIGHT:y_off+=icon["h"]+2+bo;x_off=bo;break;}}}}}function TMK_slide_div(window_id,from_x,from_y,to_x,to_y,duration,final){let obj;let delta_x;let delta_y;let iterations;iterations=64;delta_x=(to_x - from_x)/(duration * iterations);delta_y=(to_y - from_y)/(duration * iterations);if(obj=TMK_get_window_obj(window_id))move_it(obj,window_id,1000 / iterations,from_x,from_y,to_x,to_y,delta_x,delta_y,0,parseInt(duration * iterations),final);}function move_it(obj,window_id,delay,fx,fy,tx,ty,dx,dy,count,max,final){let rect;let foo_x;let foo_y;rect=obj.getBoundingClientRect();foo_x=(obj.offsetWidth  - rect.width);foo_y=(obj.offsetHeight - rect.height);fx+=dx;fy+=dy;obj.style.left=(fx -(foo_x / 2))+"px";obj.style.top=(fy -(foo_y / 2))+"px";if(++count< max)setTimeout(move_it,delay,obj,window_id,delay,fx,fy,tx,ty,dx,dy,count,max,final);else{if(final)TMK_set_window_position(window_id,{x:tx,y:ty});}}function ba(window_id){let data;let func;if(data=bl[window_id]){if(func=TMK_get_private_window_arg(window_id,"onclose")){console.log("  Have close func");console.log(func);}TMK_smooth_close(data["window"]);}}function bb(window_id,arg,action){let data;let menu;if(data=bl[arg]){menu=data["menu"];if(action==TMK_WINDOW_MINIMIZE){TMK_menu_item_enable(menu,1);TMK_menu_item_disable(menu,3);}else{TMK_menu_item_disable(menu,1);TMK_menu_item_enable(menu,3);}}}function bc(window_id){let mini;let data;let menu;if(data=bl[window_id]){mini=TMK_toggle_minimize(data["window"]);if(menu=data["menu"]){if(mini==TMK_WINDOW_MINIMIZE){TMK_menu_item_enable(menu,4);TMK_menu_item_hide(menu,3);}else{TMK_menu_item_enable(menu,3);TMK_menu_item_hide(menu,4);}}}}function be(e,icon_obj,window_id,onclick,menu){let x;let y;let coords;e.preventDefault();if(0 &&(coords=TMK_get_window_position(window_id))){x=coords["x"]+coords["w"];y=coords["y"];}else{x=e.clientX+4;y=e.clientY - 6;}TMK_menu({x:x,y:y,fit:true,menu:menu,});}function bf(window_id,icon_id){let icon;if(icon=bj[icon_id]){TMK_set_window_zindex(icon["image"],500);TMK_set_window_zindex(icon["text"],500);}}function bg(window_id,icon_id){let func;let icon;let coords;let text_coords;if(icon=bj[icon_id]){if(TMK_window_exists(icon["text"])){coords=TMK_get_window_position(icon["image"]);text_coords={};text_coords["x"]=coords["x"] - br;text_coords["y"]=coords["y"]+coords["h"]+2;TMK_set_window_position(icon["text"],text_coords);TMK_window_raise(icon["text"]);if(func=icon["onmove"])func(icon_id,icon["arg"],coords);}}}function bh(e,icon_id){let obj;let func;let icon;e.preventDefault();if(icon=bj[icon_id]){if(func=icon["func"]){if(typeof func=="function")func(icon["launchpad"]);else if(typeof func=="string")eval(func);if(obj=document.getElementById("TMK-icon-text"+icon["text"])){obj.classList.remove("TMK-icon-inactive");obj.classList.add("TMK-icon-active");}}}}function TMK_set_icon_args(args){bk=dup_args(args);}function TMK_launchpad_create(args){let x;let y;let w;let h;let axis;let tmp;let launchpad_id;if(arguments.length==0)args={};else if(typeof args!="object")return;launchpad_id=TMK_make_random_id();x=(typeof args["x"]=="undefined")? 0:parseInt(args["x"]);y=(typeof args["y"]=="undefined")? 0:parseInt(args["y"]);w=(typeof args["w"]=="undefined")? window.innerWidth:parseInt(args["w"]);h=(typeof args["h"]=="undefined")? bq:parseInt(args["h"]);axis=args["axis"] ? args["axis"]:TMK_AXIS_BOTTOM;if(x< 0)x=0;if(y< 0)y=0;if(axis==TMK_AXIS_BOTTOM || axis==TMK_AXIS_TOP){if(w< 0)w=window.innerWidth+(w * 2);if(h< 0)h=window.innerHeight+(h * 2);}else{if(w< 0)w=window.innerHeight+(w * 2);if(h< 0)h=window.innerWidth+(h * 2);}if(w< bp)w=bp;if(h< bq)h=bq;if(x+bp> window.innerWidth)x=window.innerWidth - bp;if(y+bq> window.innerHeight)y=window.innerHeight - bq;if(x+w> window.innerWidth)w=window.innerWidth - x;if(y+h> window.innerHeight)h=window.innerHeight - y;if(axis==TMK_AXIS_LEFT || axis==TMK_AXIS_RIGHT){tmp=w;w=h;h=tmp;tmp=x;x=y;y=tmp;}TMK_window_open({x:x,y:y,w:w,h:h,axis:axis,radius:args["radius"],noheader:true,inactive:true,zindex:20,bcolor:args["bgcolor"] ? args["bgcolor"]:"#DADADA",window_id:launchpad_id,});bm[launchpad_id]={id:launchpad_id,x:x,y:y,w:w,h:h,axis:axis,icons:[],};return launchpad_id;}function TMK_launchpad_add_window(launchpad_id,window_id,icon_img,tag,bgcolor){let obj;let u_arg;let window;let icon_id;let launchpad;let icon_image_id;if(launchpad=bm[launchpad_id]){window=TMK_get_window(window_id);icon_id=TMK_icon({launchpad:launchpad_id,active:window_id,icon:icon_img,noborder:true,bcolor:bgcolor ? bgcolor:"#D5D5E5",tag:tag ? tag:(window ? window["header"]:"Window"),open:function(){return window_id},text:window["header"],});TMK_set_private_window_arg(window_id,"onclose",window["onclose"]);icon_image_id=bj[icon_id]["image"];if(obj=TMK_get_window_obj(icon_image_id)){obj.classList.add("fadein");setTimeout( function(){obj.classList.remove("fadein");},250);}if(obj=TMK_get_window_obj(bj[icon_id]["text"])){obj.classList.add("fadein");setTimeout( function(){obj.classList.remove("fadein");},250);}window["launchpad"]=launchpad_id;window["onclose"]=az;window["onminimize"]=bb;window["icon"]=icon_image_id;bl[icon_image_id]={id:icon_image_id,menu:null,window:window_id,static:false,state:"open",arg:window["arg"],launchpad:launchpad_id,};}return icon_image_id;}function TMK_get_launchpad(launchpad_id){return bm[launchpad_id];}let bu=null;let bv=null;let bw=null;let bx=null;const TMK_modal_button1="TMK-modal-button1";const TMK_modal_button2="TMK-modal-button2";const TMK_modal_button3="TMK-modal-button3";let by={button1_text:"button1_text",button2_text:"button2_text",button3_text:"button3_text",onbutton1:"onbutton1",onbutton2:"onbutton2",onbutton3:"onbutton3",class:"class",};function TMK_error(args){let defaults;let overrides;if(arguments.length==0)args="";if(typeof args!="object")args={html:args.toString(),shadow:true,};overrides={};defaults={};overrides["button1_text"]=args["ok_text"];overrides["onbutton1"]=null;overrides["button_count"]=1;defaults["keyboard"]=true;defaults["header"]="Error";defaults["exclusive"]=true;return TMK_modal(TMK_make_window_args(args,overrides,defaults,by,bu));}function TMK_confirmation(args){let defaults;let overrides;if(arguments.length==0)args="";if(typeof args!="object")args={html:args.toString(),shadow:true,};overrides={};defaults={};overrides["button_count"]=1;overrides["onbutton1"]=args["onok"];overrides["button1_text"]=args["ok_text"];defaults["keyboard"]=true;defaults["header"]="Confirmation";defaults["exclusive"]=true;return TMK_modal(TMK_make_window_args(args,overrides,defaults,by,bv));}function TMK_question(args){let defaults;let overrides;if(arguments.length==0)args="";if(typeof args!="object")args={html:args.toString(),shadow:true,};overrides={};defaults={};overrides["button_count"]=2;overrides["onbutton1"]=args["onyes"];overrides["onbutton2"]=args["onno"];overrides["button1_text"]=args["yes_text"];overrides["button2_text"]=args["no_text"];defaults["keyboard"]=true;defaults["header"]="Question";defaults["exclusive"]=true;return TMK_modal(TMK_make_window_args(args,overrides,defaults,by,bu));}function TMK_save_delete_cancel(args){let defaults;let overrides;if(arguments.length==0)args="";if(typeof args!="object")args={html:args.toString(),shadow:true,};overrides={};defaults={};overrides["button_count"]=3;overrides["onbutton1"]=args["onsave"];overrides["onbutton2"]=args["oncancel"];overrides["onbutton3"]=args["ondelete"];overrides["button1_text"]=args["save_text"];overrides["button2_text"]=args["delete_text"];overrides["button3_text"]=args["cancel_text"];defaults["keyboard"]=true;defaults["header"]="Save";defaults["exclusive"]=true;return TMK_modal(TMK_make_window_args(args,overrides,defaults,by,bx));}function TMK_modal(args){let html;let wargs;let button;let header;let radius;let content;let window_id;let class_text;let button_count;let button1_text;let button2_text;let button3_text;button_count=args["button_count"];button1_text=TMK_text_to_html(args["button1_text"]);button2_text=TMK_text_to_html(args["button2_text"]);button3_text=TMK_text_to_html(args["button3_text"]);args["box"]=TMK_DIMS_CONTENT;window_id=TMK_make_random_id();if(button_count==3){if(!button1_text)button1_text="Save";if(!button2_text)button2_text="Cancel";if(!button3_text)button3_text="Delete";}else if(button_count==2){if(!button1_text)button1_text="Yes";if(!button2_text)button2_text="No";}else if(button_count==1){if(!button1_text)button1_text=" OK ";}else button_count=0;if(typeof args["radius"]==="undefined")radius="5px";else radius=args["radius"]+"px";html="";content=args["html"] ?  args["html"]:"";class_text=args["class"] ?("class='"+args["class"]+"'"):"";if(button_count> 0)html+="<div style='height:10px'></div><div "+class_text+" style='margin:0px 10px 10px 10px'>"+content+"</div>";else html+="<div "+class_text+">"+content+"</div>";html+="<table cellpadding=0 cellspacing=0 width=100%>";if(button_count> 0){html+="<tr><td>";html+="<table cellpadding=0 cellspacing=0 width=100% border=0>";html+="<tr>";if(button_count==3){html+="<td width=5% align=middle></td>";html+="<td width=26% align=middle>";html+="<input id="+TMK_modal_button1+window_id+" type=button class=TMK-modal-button value=\" "+button1_text+" \">";html+="</td>";html+="<td width=5% align=middle></td>";html+="<td width=28% align=middle>";html+="<input id="+TMK_modal_button2+window_id+" type=button class=TMK-modal-button value=\" "+button2_text+" \">";html+="</td>";html+="<td width=5% align=middle></td>";html+="<td width=26% align=middle>";html+="<input id="+TMK_modal_button3+window_id+" type=button class=TMK-modal-button value=\" "+button3_text+" \">";html+="<td width=5% align=middle></td>";html+="</td>";}else if(button_count==2){html+="<td width=40% align=middle>";html+="<input id="+TMK_modal_button1+window_id+" type=button class=TMK-modal-button value=\" "+button1_text+" \">";html+="</td>";html+="<td width=20% align=middle></td>";html+="<td width=40% align=middle>";html+="<input id="+TMK_modal_button2+window_id+" type=button class=TMK-modal-button value=\" "+button2_text+" \">";html+="</td>";}else if(button_count==1){html+="<td align=middle>";html+="<input id="+TMK_modal_button1+window_id+" type=button class=TMK-modal-button value=\" "+button1_text+" \">";html+="</td>";}html+="</tr>";html+="</table>";html+="</td></tr>";html+="<tr><td height=10></td></tr>";}html+="</table>";wargs=dup_args(args);wargs["html"]=html;wargs["window_id"]=window_id;if(window_id=TMK_window_open(wargs)){let obj;bt(window_id,TMK_modal_button1+window_id,args["onbutton1"],args["arg"]);bt(window_id,TMK_modal_button2+window_id,args["onbutton2"],args["arg"]);bt(window_id,TMK_modal_button3+window_id,args["onbutton3"],args["arg"]);bt(window_id,"style1"+window_id,null,args["arg"]);if(obj=TMK_get_window_obj(window_id)){obj.classList.add("fadein-fast");if(args["keyboard"])obj.addEventListener("keydown",function(){bs(event,window_id)});}}return window_id;}function bs(e,window_id){let c;let obj;let func;c=e.which || e.keyCode;if(c==13){if(obj=document.getElementById(TMK_modal_button1+window_id)){e.preventDefault();obj.click();}}else if(e.key==="Escape"){if(obj=document.getElementById(TMK_modal_button2+window_id)){e.preventDefault();obj.click();}}}function bt(window_id,button_id,func,arg){let ret;let coords;let button;if(button=document.getElementById(button_id)){button.addEventListener("click",function(){ret=false;if(func){coords=TMK_get_window_position(window_id);ret=func(arg,coords);}if(!ret)TMK_window_close(window_id);});}}function TMK_set_error_args(args){bu=dup_args(args);}function TMK_set_confirmation_args(args){bv=dup_args(args);}function TMK_set_question_args(args){bw=dup_args(args);}function TMK_set_save_delete_cancel_args(args){bx=dup_args(args);}function TMK_set_all_args(args){bu=dup_args(args);bv=dup_args(args);bw=dup_args(args);bx=dup_args(args);}let eo;let TMK_windows={};let ep=[];let eq=-1;let er=-1;const TMK_MIN_WIDTH=16;const TMK_MIN_HEIGHT=2;const TMK_MAX_WIDTH=3000;const TMK_MAX_HEIGHT=3000;const TMK_IS_MOUSE_MOVE=1;const TMK_IS_TOUCH_MOVE=2;const TMK_IS_MOUSE_RESIZE=3;const TMK_IS_TOUCH_RESIZE=4;const TMK_WINDOW_MINIMIZE=1;const TMK_WINDOW_UNMINIMIZE=2;let es="TMK-window-";let et="TMK-header-";let eu="TMK-content-";let ev="TMK-background-";let ew="TMK-save-";let ex="TMK-active-";const TMK_AXIS_LEFT="left";const TMK_AXIS_TOP_LEFT="top-left";const TMK_AXIS_TOP="top";const TMK_AXIS_TOP_RIGHT="top-right";const TMK_AXIS_RIGHT="right";const TMK_AXIS_BOTTOM_RIGHT="bottom-right";const TMK_AXIS_BOTTOM="bottom";const TMK_AXIS_BOTTOM_LEFT="bottom-left";let ey="TMK-mini-";let ez="TMK-close-";let fa="TMK-maxi-";const TMK_DIMS_WINDOW="window";const TMK_DIMS_CONTENT="content";function TMK_window_open(args){let x;let y;let d;let id;let key;let obj;let win;let html;let rect;let bcolor;let bimage;let header;let parent;let radius;let zindex;let dragable;let exclusive;let parent_id;let window_id;let background;let top_zindex;let parent_obj;let keyboard_count;if(eq<=0 || er<=0){eq=window.innerWidth;er=window.innerHeight;window.addEventListener('resize',ca);}background=null;top_zindex=-1;if(win=document.createElement("div")){if(!(window_id=args["window_id"]))window_id=TMK_make_random_id();for(key in TMK_windows){if((zindex=TMK_windows[key]["zindex"])> top_zindex)top_zindex=zindex;if(args["header"] && !args["noheader"]){if(obj=TMK_get_header_obj(key)){obj.classList.remove("TMK-window-header-active");obj.classList.add("TMK-window-header");}}}if(typeof(zindex=args["zindex"])==="undefined")zindex=(top_zindex==-1)? 1000:(top_zindex+100);if(typeof(radius=args["radius"])=="undefined")radius=7;parent_id=args["parent"];win.id=es+window_id;win.style.position=parent_id ? "absolute":"fixed";win.style.top="0px";win.style.left="0px";win.style.zIndex=zindex.toString();win.style.display="block";win.style.visibility=(typeof args["display"]=="undefined")? "visible":((args["display"])? "visible":"hidden");win.style.borderRadius=radius+"px";win.style.boxSizing="content-box";win.tabIndex=0;win.onfocus=function(){bz(window_id,5)};exclusive=args["exclusive"] || args["selfish"];if(args["keyboard"]){for(key in TMK_windows){if(TMK_windows[key]["keyboard"]){if(obj=TMK_get_window_obj(key))obj.tabIndex=0;}}win.tabIndex=1;}header=cb(args,exclusive,radius,zindex,window_id);html="";html+=header["html"];html+="<div id="+eu+window_id;html+=" style='";if(typeof args["overflow"]!="undefined"){if(args["overflow"]=="wrap")html+="overflow:hidden;word-wrap:break-word;";else html+="overflow:"+args["overflow"]+";";}else html+="overflow:auto;";html+="border:0px solid blue;";html+="box-sizing:border-box;";bcolor=args["bcolor"] ? args["bcolor"]:"#FFF";html+="background:"+bcolor+";";if(header["html"])html+="border-bottom-left-radius:"+(radius - 1)+"px;border-bottom-right-radius:"+(radius - 1)+"px;";else html+="border-radius:"+(radius - 1)+"px";html+="'>";html+="<div style='";if(bcolor=args["bcolor"])html+="background:"+bcolor+";";html+=" height:100%;width:100%;";html+="'>";html+=args["html"] ? args["html"]:"";html+="</div>";html+="</div>";win.innerHTML=html;if(exclusive){if(background=TMK_background(ev+window_id,zindex - 1,null)){document.body.insertBefore(background,null);background.classList.add("TMK-window-background");if(args["selfish"])background.addEventListener("click",function(){TMK_window_close(window_id)});}}if(args["shadow"])win.classList.add("TMK-window-shadow");if(args["noborder"])win.classList.add("TMK-window-no-border");else win.classList.add("TMK-window");if((parent_id=args["parent"])&&(parent_obj=TMK_get_content_obj(parent_id)))parent_obj.appendChild(win);else document.body.insertBefore(win,null);if(args["dragable"]){if(dragable=document.getElementById(header["active"])){dragable.addEventListener("mousedown",function(){TMK_start_mouse_move(event,window_id)});dragable.addEventListener("touchstart",function(){cg(event,window_id)});}}if(0 && args["activity"]){let target;let observer;if((target=document.getElementById(TMK_get_content_id(window_id)))){observer=new MutationObserver( function(mutations){let m;for(m of mutations)TMK_console_log("TYPE="+m.type);});var config={attributes:true,childList:true,characterData:true,subtree:true,};observer.observe(target,config);}}d=new Date();TMK_windows[window_id]={id:args["id"],closed:false,autosave:args["autosave"],window_id:window_id,keyboard:args["keyboard"],header:args["header"],noheader:args["noheader"],inactive:args["inactive"],x:0,y:0,w:0,h:0,zindex:zindex,type:args["type"],style:args["style"],tstamp:d.getTime(),arg:args["arg"],onmove:args["onmove"],onmoved:args["onmoved"],onresize:args["onresize"],onresized:args["onresized"],onminimize:args["onminimize"],onclose:args["onclose"],onbutton1:args["onbutton1"],onbutton2:args["onbutton2"],onbutton3:args["onbutton3"],resize:args["resize"],launchpad:args["launchpad"],min_w:args["min_w"],max_w:args["max_w"],min_h:args["min_h"],max_h:args["max_h"],axis:args["axis"],state:"open",radius:radius,robjs:null,private:{},parent:args["parent"],};cf(window_id,args);ce(window_id,args);cr(window_id);if(!args["inactive"])bz(window_id,1);if(args["focus"])document.getElementById(args["focus"]).focus();}return window_id;}function bz(window_id,dbg){let i;let key;let obj;let win;let count;if(win=TMK_windows[window_id]){if(!win["closed"] && !win["inactive"]){for(key in TMK_windows){if(obj=TMK_get_window_obj(key))obj.tabIndex=0;if(obj=TMK_get_header_obj(key)){obj.classList.remove("TMK-window-header-active");obj.classList.add("TMK-window-header");}}if(obj=TMK_get_window_obj(window_id)){if(win["keyboard"])obj.tabIndex=1;obj.focus();if(obj=TMK_get_header_obj(window_id))obj.classList.add("TMK-window-header-active");}TMK_window_raise(window_id);if((count=ep.length)> 1){if(ep[count - 1]!=window_id){for(i=0;i< count;i++){if(ep[i]==window_id){ep.splice(i,1);i--;count--;}}}}ep.push(window_id);}}}function TMK_window_fit(window_id){let w;let h;let max;let wobj;let rect;let content;if(wobj=TMK_get_window_obj(window_id)){if(content=TMK_get_content_obj(window_id)){rect=content.getBoundingClientRect();if(content.scrollHeight){if(content.scrollHeight> rect.height){let nsb;let style;let header;let header_rect;let header_height;style=window.getComputedStyle(wobj);nsb=parseInt(style.getPropertyValue("border-top-width").replace("px",""));nsb+=parseInt(style.getPropertyValue("border-bottom-width").replace("px",""));if(header=TMK_get_header_obj(window_id)){header_rect=header.getBoundingClientRect();header_height=header_rect.height;}else header_height=0;if((h=content.scrollHeight)>(max=TMK_windows[window_id]["max_h"]))h=max;TMK_set_window_position(window_id,{h:h+header_height});content.style.height=h+"px";}if(content.scrollWidth> rect.width){if((w=content.scrollWidth)>(max=TMK_windows[window_id]["max_w"]))w=max;TMK_set_window_position(window_id,{w:w});content.style.width=w+"px";}}}TMK_toggle_maximize(window_id);TMK_toggle_maximize(window_id);}}function ca(){let h;let w;let key;let obj;let win;let axis;let func;let new_x;let new_y;let old_x;let old_y;let delta_x;let delta_y;for(key in TMK_windows){win=TMK_windows[key];if(!win["parent"]){delta_x=window.innerWidth  - eq;delta_y=window.innerHeight - er;}if(axis=win["axis"]){if(obj=TMK_get_window_obj(key)){new_x=old_x=win["x"];new_y=old_y=win["y"];if(axis==TMK_AXIS_BOTTOM_LEFT || axis==TMK_AXIS_BOTTOM){new_y=old_y+delta_y;obj.style.top=new_y+"px";}else if(axis==TMK_AXIS_TOP_RIGHT || axis==TMK_AXIS_RIGHT){new_x=old_x+delta_x;obj.style.left=new_x+"px";}else if(axis==TMK_AXIS_BOTTOM_RIGHT){new_x=old_x+delta_x;new_y=old_y+delta_y;obj.style.top=new_y+"px";obj.style.left=new_x+"px";}if(new_x!=old_x || new_y!=old_y){TMK_set_window_position(key,{x:new_x,y:new_y});if(func=win["onmove"])func(window_id,win["arg"],TMK_get_window_position(key));}}}if(win["state"]=="fullsize"){if(obj=TMK_get_window_obj(key))TMK_set_window_position(key,{w:window.innerWidth,h:window.innerHeight});if(obj=TMK_get_content_obj(key)){let header;let header_height;if(header=TMK_get_header_obj(key)){let header_rect;header_rect=header.getBoundingClientRect();header_height=header_rect.height;}else header_height=0;obj.style.width=window.innerWidth+"px";obj.style.height=(window.innerHeight - header_height)+"px";}}}eq=window.innerWidth;er=window.innerHeight;}function cb(args,exclusive,radius,zindex,window_id){let html;let style;let width;let resize;let header_id;let active_id;let header_html;html="";header_id=null;resize=args["resize"];if(args["header"] && !args["noheader"]){header_id=et+window_id;active_id=ex+window_id;header_html=TMK_text_to_html(args["header"]);html="<div class=TMK-window-header-active id="+header_id+" style='border-top-left-radius:"+radius+"px;border-top-right-radius:"+radius+"px'>";if(style=args["style"]){if(style=="auto"){if(navigator.userAgent.indexOf("Macintosh")>=0)args["style"]="mac";else if(navigator.userAgent.indexOf("Windows")>=0)args["style"]="win";else if(navigator.userAgent.indexOf("Android")>=0)args["style"]="win";else args["style"]="win";}zindex++;if(args["style"]=="mac"){html+="<table border=0 bordercolor=red cellpadding=0 cellspacing=0 width=100%>";html+="<tr>";width=exclusive ? 20:(resize ? 60:40);html+="<td align=left width="+width+">";html+="<table cellpadding=0 cellspacing=0 width=100%>";html+="<tr><td>";if(exclusive)html+="<td><div align=center style='z-index:"+zindex+"' id="+ez+window_id+" class=TMK-mac-close onclick='TMK_smooth_close(\""+window_id+"\");'></div></td>";else{width=resize ? 33:50;html+="<td align=center width="+width+"%><div style='z-index:"+zindex+"' id="+ez+window_id+" class=TMK-mac-close    onclick='TMK_smooth_close(\""+window_id+"\");'></div></td>";html+="<td align=center width="+width+"%><div style='z-index:"+zindex+"' id="+ey+window_id+" class=TMK-mac-minimize onclick='TMK_toggle_minimize(\""+window_id+"\");'></div></td>";if(resize)html+="<td width="+width+"%><div style='z-index:"+zindex+"' id="+fa+window_id+" class=TMK-mac-maximize onclick='TMK_toggle_maximize(\""+window_id+"\");'></div></td>";}html+="</tr>";html+="</table>";html+="</td>";html+="<td align=center><div "+" onclick='bz(\""+window_id+"\",2)'"+" ondblclick='TMK_toggle_minimize(\""+window_id+"\");'"+">"+header_html+"</div></td>";html+="<td width="+width+" onclick='bz(\""+window_id+"\",2)'"+" ondblclick='TMK_toggle_minimize(\""+window_id+"\");'"+"</td>";html+="</tr>";html+="</table>";}else if(args["style"]=="win"){html+="<table cellpadding=0 cellspacing=0 width=100%>";html+="<tr>";html+="<td><div id="+active_id+" onclick='bz(\""+window_id+"\",2)'"+" ondblclick='TMK_toggle_minimize(\""+window_id+"\");'"+">"+header_html+"</div></td>";width=exclusive ? 30:75;width=exclusive ? 25:(resize ? 75:50);html+="<td width="+width+" align=right>";html+="<table border=0 cellpadding=0 cellspacing=0 width=100%>";html+="<tr>";if(exclusive)html+="<td align=right><div style='z-index:"+zindex+"' id="+ez+window_id+" class=TMK-win-close onclick='TMK_smooth_close(\""+window_id+"\");'>&times;</div></td>";else{width=resize ? 33:50;html+="<td width="+width+"%><div style='z-index:"+zindex+"' id="+ey+window_id+" class=TMK-win-close onclick='TMK_toggle_minimize(\""+window_id+"\");'>&minus;</div></td>";if(resize){html+="<td width="+width+"%><div style='z-index:"+zindex+"' id="+fa+window_id+" class=TMK-win-close onclick='TMK_toggle_maximize(\""+window_id+"\");'>";html+="<span style=\"position:relative;top:-2px;\">&square;</span>";html+="</div></td>";}html+="<td width="+width+"%><div style='z-index:"+zindex+"' id="+ez+window_id+" class=TMK-win-close onclick='TMK_smooth_close(\""+window_id+"\");'>&times;</div></td>";}html+="<td width=10></td>";html+="</tr>";html+="</table>";html+="</td>";html+="</tr>";html+="</table>";}else html+="<div id="+header_id+"><div id="+active_id+">"+header_html+"</div></div>";}else html+="<div id="+header_id+"><div id="+active_id+">"+header_html+"</div></div>";html+="</div>";}return{id:header_id,active:active_id,html:html};}function cc(window_id,txt){let obj;let rect;let coords;if(txt)TMK_console_log(txt+" WINDOW_ID="+window_id);else TMK_console_log("WINDOW_ID="+window_id);if(obj=TMK_get_window_obj(window_id)){rect=obj.getBoundingClientRect();TMK_console_log("  WINDOW  RECT="+parseInt(rect.left)+" / "+parseInt(rect.top)+" / "+parseInt(rect.width)+" / "+parseInt(rect.height));}if(obj=TMK_get_content_obj(window_id)){rect=obj.getBoundingClientRect();TMK_console_log("  CONTENT RECT="+parseInt(rect.left)+" / "+parseInt(rect.top)+" / "+parseInt(rect.width)+" / "+parseInt(rect.height));}if(obj=TMK_get_header_obj(window_id)){rect=obj.getBoundingClientRect();TMK_console_log("  HEADER  RECT="+parseInt(rect.left)+" / "+parseInt(rect.top)+" / "+parseInt(rect.width)+" / "+parseInt(rect.height));}if(coords=TMK_get_window_position(window_id)){TMK_console_log("  WIN COORDS="+parseInt(coords["x"])+" / "+parseInt(coords["y"])+" / "+parseInt(coords["w"])+" / "+parseInt(coords["h"]));}else TMK_console_log("Count not find coords for window");TMK_console_log("  ZINDEX="+TMK_windows[window_id]["zindex"]);}function ce(window_id,args){let x;let y;let w;let h;let obj;let axis;let state;let auto_x;let auto_y;let coords;let parent;let parent_id;let parent_obj;let window_rect;if(obj=TMK_get_window_obj(window_id)){parent_obj=null;if(parent_id=TMK_windows[window_id]["parent"]){parent_obj=TMK_get_content_obj(parent_id);}else parent_obj=window;window_rect=obj.getBoundingClientRect();if(args["center_on"] &&(parent=document.getElementById(args["center_on"]))){let rect;rect=parent.getBoundingClientRect();if((x=(rect.width - window_rect.width)/ 2)< 0)x=0;x+=rect.left;if((y=(rect.height - window_rect.height)/ 2)< 0)y=0;y+=rect.top;}else{if(typeof(x=args["x"])==="undefined"){if((x=(parent_obj.innerWidth - window_rect.width)/ 2)< 0)x=0;}else x=parseInt(args["x"]);if(typeof(y=args["y"])==="undefined"){if((y=(parent_obj.innerHeight - window_rect.height)/ 2)< 0)y=0;}else y=parseInt(args["y"]);}if(axis=args["axis"]){if(axis==TMK_AXIS_TOP_RIGHT || axis==TMK_AXIS_RIGHT)x=parent_obj.innerWidth - window_rect.width - window_rect.left - x;else if(axis==TMK_AXIS_BOTTOM_LEFT || axis==TMK_AXIS_BOTTOM)y=parent_obj.innerHeight - window_rect.height - window_rect.top - y;else if(axis==TMK_AXIS_BOTTOM_RIGHT){x=parent_obj.innerWidth - window_rect.width - window_rect.left - x;y=parent_obj.innerHeight - window_rect.height - window_rect.top - y;}}h=window_rect.height;w=window_rect.width;if(args["fit"]){if(x+w> eq)x=eq - w;if(y+h> er)y=er - h;}if(x< 0)x=0;if(y< 0)y=0;if(typeof auto_x!=="undefined")x=auto_x;if(typeof auto_y!=="undefined")y=auto_y;TMK_set_window_position(window_id,{x:x,y:y});}}function cf(window_id,args){let h;let w;let ewb;let nsb;let obj;let tmp;let max_w;let max_h;let min_w;let min_h;let delta;let state;let style;let auto_h;let auto_w;let coords;let header;let content;let header_rect;let content_rect;let header_height;if(obj=TMK_get_window_obj(window_id)){if(content=TMK_get_content_obj(window_id)){content_rect=content.getBoundingClientRect();min_w=args["min_w"];max_w=args["max_w"];if(typeof min_w=="undefined" || min_w< TMK_MIN_WIDTH)min_w=TMK_windows[window_id]["min_w"]=TMK_MIN_WIDTH;if(typeof max_w=="undefined" || max_w> TMK_MAX_WIDTH)max_w=TMK_windows[window_id]["max_w"]=TMK_MAX_WIDTH;if(min_w> max_w){tmp=max_w;max_w=min_w;min_w=tmp;}TMK_windows[window_id]["min_w"]=min_w;TMK_windows[window_id]["max_w"]=max_w;min_h=TMK_windows[window_id]["min_h"];max_h=TMK_windows[window_id]["max_h"];if(typeof min_h=="undefined" || min_h< TMK_MIN_HEIGHT)min_h=TMK_windows[window_id]["min_h"]=TMK_MIN_HEIGHT;if(typeof max_h=="undefined" || max_h> TMK_MAX_HEIGHT)max_h=TMK_windows[window_id]["max_h"]=TMK_MAX_HEIGHT;if(min_h> max_h){tmp=max_h;max_h=min_h;min_h=tmp;}TMK_windows[window_id]["min_h"]=min_h;TMK_windows[window_id]["max_h"]=max_h;if(header=TMK_get_header_obj(window_id)){header_rect=header.getBoundingClientRect();header_height=header_rect.height;}else header_height=0;style=window.getComputedStyle(obj);nsb=parseInt(style.getPropertyValue("border-top-width").replace("px",""));nsb+=parseInt(style.getPropertyValue("border-bottom-width").replace("px",""));ewb=parseInt(style.getPropertyValue("border-left-width").replace("px",""));ewb+=parseInt(style.getPropertyValue("border-right-width").replace("px",""));if(state=="fullsize"){w=args["w"];h=args["h"];}else{w=auto_w ?(auto_w - ewb):args["w"];h=auto_h ?(auto_h - header_height):args["h"];}if(typeof w!="undefined")w=parseInt(w);else w=content_rect.right - content_rect.left;if(w< min_w)w=min_w;else if(w> max_w)w=max_w;if(typeof h!="undefined")h=parseInt(h);else h=content_rect.height;if(h< min_h)h=min_h;else if(h> max_h)h=max_h;if(typeof args["box"]=="undefined" || args["box"]!=TMK_DIMS_WINDOW){content.style.height=h+"px";content.style.width=w+"px";obj.style.height=(h+header_height)+"px";obj.style.width=w+"px";TMK_windows[window_id]["w"]=w;TMK_windows[window_id]["h"]=h+header_height;}else{h -=nsb;w -=ewb;content.style.height=(h - header_height)+"px";content.style.width=w+"px";obj.style.height=h+"px";obj.style.width=w+"px";TMK_windows[window_id]["w"]=w+ewb;TMK_windows[window_id]["h"]=h+nsb;}}if(state=="fullsize"){TMK_window_fit(window_id);TMK_toggle_maximize(window_id);}else if(state=="closed"){TMK_window_fit(window_id);TMK_toggle_minimize(window_id);}}}function TMK_start_mouse_move(e,window_id){if(e.which==1){e.preventDefault();ch(e.clientX,e.clientY,window_id,TMK_IS_MOUSE_MOVE);}}function cg(e,window_id){let touchobj;touchobj=null;if(e.changedTouches)touchobj=e.changedTouches[0];if(touchobj){e.preventDefault();ch(touchobj.clientX,touchobj.clientY,window_id,TMK_IS_TOUCH_MOVE);}}function TMK_window_raise(window_id){let key;let obj;let win;let zindex;let top_zindex;top_zindex=-1;if(win=TMK_windows[window_id]){for(key in TMK_windows){if(key!=window_id){if(eg(win,TMK_windows[key])){zindex=TMK_windows[key]["zindex"];if(win["zindex"]<=zindex){if(zindex> top_zindex)top_zindex=zindex;}}}}if(obj=TMK_get_window_obj(window_id)){if(top_zindex!=-1){obj.style.zIndex=(top_zindex+100).toString();win["zindex"]=top_zindex+100;}}}}function ch(x,y,window_id,what){let obj;if(TMK_windows[window_id]){if(TMK_windows[window_id]["state"]!="fullsize"){TMK_window_raise(window_id);cp("none");if(what==TMK_IS_MOUSE_MOVE){window.addEventListener("mouseup",cl);window.addEventListener("mousemove",cj);}else if(what==TMK_IS_TOUCH_MOVE){window.addEventListener("touchend",cm);window.addEventListener("touchmove",ck);}eo={action:"move",window_id:window_id,start_x:x,start_y:y,last_x:x,last_y:y};}}}function cj(e){e.preventDefault();if(e.clientX!=eo["last_x"] || e.clientY!=eo["last_y"]){eo["last_x"]=e.clientX;eo["last_y"]=e.clientY;TMK_window_raise(eo["window_id"]);if(eo["action"]=="move")co(eo["window_id"]);else if(eo["action"]=="resize")ec(eo["window_id"]);}}function ck(e){let touchobj;e.preventDefault();if(e.changedTouches){if(touchobj=e.changedTouches[0]){if(touchobj.clientX!=eo["last_x"] || touchobj.clientY!=eo["last_y"]){eo["last_x"]=touchobj.clientX;eo["last_y"]=touchobj.clientY;TMK_window_raise(eo["window_id"]);if(eo["action"]=="move")co(eo["window_id"]);else if(eo["action"]=="resize")ec(eo["window_id"]);}}}}function cl(e){e.preventDefault();cn(TMK_IS_MOUSE_MOVE);}function cm(e){e.preventDefault();cn(TMK_IS_TOUCH_MOVE);}function cn(what){let obj;let func;let rect;let argname;let window_id;cp("auto");if(window_id=eo["window_id"]){if(TMK_windows[window_id]){if(obj=TMK_get_window_obj(window_id)){rect=obj.getBoundingClientRect();TMK_windows[window_id]["x"]=rect.left;TMK_windows[window_id]["y"]=rect.top;TMK_windows[window_id]["w"]=rect.width;TMK_windows[window_id]["h"]=rect.height;}}if(what==TMK_IS_MOUSE_MOVE){window.removeEventListener("mouseup",cl);window.removeEventListener("mousemove",cj);argname="onmoved";}else if(what==TMK_IS_TOUCH_MOVE){window.removeEventListener("touchend",cm);window.removeEventListener("touchmove",ck);argname="onmoved";}else if(what==TMK_IS_MOUSE_RESIZE){window.removeEventListener("mouseup",ea);window.removeEventListener("mousemove",cj);argname="onresized";cr(eo["window_id"]);}else if(what==TMK_IS_TOUCH_RESIZE){window.removeEventListener("touchend",eb);window.removeEventListener("touchmove",ck);argname="onresized";cr(eo["window_id"]);}if(TMK_windows[window_id]){if(func=TMK_windows[window_id][argname])func(window_id,TMK_windows[window_id]["arg"],{x:rect.left,y:rect.top,w:rect.width,h:rect.height});}eo={};}}function co(window_id){let x;let y;let obj;let rect;let func;let coords;let win;if(win=TMK_windows[window_id]){if(obj=TMK_get_window_obj(window_id)){rect=obj.getBoundingClientRect();x=(rect.left+(eo["last_x"] - eo["start_x"]));y=(rect.top+(eo["last_y"] - eo["start_y"]));obj.style.left=x+"px";obj.style.top=y+"px";eo["start_x"]=eo["last_x"];eo["start_y"]=eo["last_y"];win["x"]=x;win["y"]=y;if(func=win["onmove"]){coords=TMK_get_window_position(window_id);func(window_id,win["arg"],coords);}}}}function cp(value){let key;let obj;for(key in TMK_windows){if(obj=TMK_get_content_obj(key))obj.style.pointerEvents=value;}}function cq(window_id){let i;let robjs;if(robjs=TMK_windows[window_id]["robjs"]){for(i=0;i< robjs.length;i++)robjs[i].remove();}}function cr(window_id){let i;let x;let y;let w;let h;let obj;let rect;let size;let robjs;let win;if(win=TMK_windows[window_id]){if(win["state"]!="fullsize"){if(win["resize"]){if(obj=TMK_get_window_obj(window_id)){rect=obj.getBoundingClientRect();x=0;y=0;w=rect.width  -(obj.offsetWidth  - obj.clientWidth);h=rect.height -(obj.offsetHeight - obj.clientHeight);size=6;robjs=[];robjs.push(cs(obj,y,x,size,size,"tl1",TMK_AXIS_TOP_LEFT,window_id));robjs.push(cs(obj,y,x+size,size,size,TMK_AXIS_TOP_LEFT,"tl2",window_id));robjs.push(cs(obj,y+size,x,size,size,TMK_AXIS_TOP_LEFT,"tl3",window_id));robjs.push(cs(obj,y,x+(size * 2),w -(size * 4),size,"t1",TMK_AXIS_TOP,window_id));robjs.push(cs(obj,y,x+w - size,size,size,"tr1",TMK_AXIS_TOP_RIGHT,window_id));robjs.push(cs(obj,y,x+w -(size * 2),size,size,"tr2",TMK_AXIS_TOP_RIGHT,window_id));robjs.push(cs(obj,y+size,x+w - size,size,size,"tr3",TMK_AXIS_TOP_RIGHT,window_id));robjs.push(cs(obj,y+(size * 2),x+w - size,size,h -(size * 4),"r1",TMK_AXIS_RIGHT,window_id));robjs.push(cs(obj,y+h - size,x+w - size,size,size,"br1",TMK_AXIS_BOTTOM_RIGHT,window_id));robjs.push(cs(obj,y+h -(size * 2),x+w - size,size,size,"br2",TMK_AXIS_BOTTOM_RIGHT,window_id));robjs.push(cs(obj,y+h - size,x+w -(size * 2),size,size,"br3",TMK_AXIS_BOTTOM_RIGHT,window_id));robjs.push(cs(obj,y+h - size,size * 2,w -(size * 4),size,"b1",TMK_AXIS_BOTTOM,window_id));robjs.push(cs(obj,y+h - size,0,size,size,"bl1",TMK_AXIS_BOTTOM_LEFT,window_id));robjs.push(cs(obj,y+h -(size * 2),0,size,size,"bl2",TMK_AXIS_BOTTOM_LEFT,window_id));robjs.push(cs(obj,y+h - size,size,size,size,"bl3",TMK_AXIS_BOTTOM_LEFT,window_id));robjs.push(cs(obj,y+(size * 2),0,size,h -(size * 4),"l1",TMK_AXIS_LEFT,window_id));win["robjs"]=robjs;}}}}}function cs(obj,top,left,width,height,id,side,window_id){let ret;if(ret=document.createElement("div")){ret.style.position="absolute";ret.id=window_id+id;ret.style.top=top+"px";ret.style.left=left+"px";ret.style.width=width+"px";ret.style.height=height+"px";ret.style.display="block";ret.onmouseenter=function(){ct(window_id,id)};ret.onmouseleave=function(){cu(window_id,id)};ret.addEventListener("mousedown",function(){cx(event,ret,side,window_id)});ret.addEventListener("touchstart",function(){cy(event,ret,side,window_id)});obj.appendChild(ret);}return ret;}function ct(window_id,id){if(id=="tl1" || id=="tl2" || id=="tl3")cv(window_id,"tl1","tl2","tl3","nwse-resize");else if(id=="t1")cv(window_id,"t1","ns-resize");else if(id=="b1")cv(window_id,"b1","ns-resize");else if(id=="tr1" || id=="tr2" || id=="tr3")cv(window_id,"tr1","tr2","tr3","nesw-resize");else if(id=="r1")cv(window_id,"r1","ew-resize");else if(id=="l1")cv(window_id,"l1","ew-resize");else if(id=="br1" || id=="br2" || id=="br3")cv(window_id,"br1","br2","br3","nwse-resize");else if(id=="bl1" || id=="bl2" || id=="bl3")cv(window_id,"bl1","bl2","bl3","nesw-resize");}function cu(window_id,id){if(id=="tl1" || id=="tl2" || id=="tl3")cw(window_id,"tl1","tl2","tl3");else if(id=="t1")cw(window_id,"t1");else if(id=="b1")cw(window_id,"b1");else if(id=="tr1" || id=="tr2" || id=="tr3")cw(window_id,"tr1","tr2","tr3");else if(id=="r1")cw(window_id,"r1");else if(id=="l1")cw(window_id,"l1");else if(id=="br1" || id=="br2" || id=="br3")cw(window_id,"br1","br2","br3");else if(id=="bl1" || id=="bl2" || id=="bl3")cw(window_id,"bl1","bl2","bl3");}function cv(args){let i;let obj;let cursor;let window_id;if(arguments.length> 2){window_id=arguments[0];cursor=arguments[arguments.length - 1];for(i=1;i< arguments.length - 1;i++){if(obj=document.getElementById(window_id+arguments[i])){obj.dataset.cursor=obj.style.cursor;obj.style.cursor=cursor;}}}}function cw(args){let i;let obj;let window_id;if(arguments.length> 1){window_id=arguments[0];for(i=1;i< arguments.length;i++){if(obj=document.getElementById(window_id+arguments[i])){if(obj.dataset.cursor)obj.style.cursor=obj.dataset.cursor;}}}}function cx(e,obj,side,window_id){if(e.which==1){e.preventDefault();cz(e.clientX,e.clientY,obj,side,window_id,TMK_IS_MOUSE_RESIZE);}}function cy(e,obj,side,window_id){let touchobj;touchobj=null;if(e.changedTouches)touchobj=e.changedTouches[0];if(touchobj){e.preventDefault();cz(touchobj.clientX,touchobj.clientY,obj,side,window_id,TMK_IS_TOUCH_RESIZE);}}function cz(x,y,obj,side,window_id,what){let i;let dlx;let drx;let dly;let dry;let wobj;let rect;if(TMK_windows[window_id]){if(TMK_windows[window_id]["state"]!="fullsize"){TMK_window_raise(window_id);cp("none");cq(window_id);if(what==TMK_IS_MOUSE_RESIZE){window.addEventListener("mouseup",ea);window.addEventListener("mousemove",cj);}else if(what==TMK_IS_TOUCH_RESIZE){window.addEventListener("touchend",eb);window.addEventListener("touchmove",ck);}dlx=drx=dly=dry=0;if(wobj=TMK_get_window_obj(window_id)){rect=wobj.getBoundingClientRect();dlx=x - rect.left;drx=x -(rect.left+rect.width);dly=y - rect.top;dry=y -(rect.top+rect.height);}eo={window_id:window_id,side:side,action:"resize",dlx:dlx,drx:drx,dly:dly,dry:dry,last_x:x,last_y:y,};}}}function ea(e){e.preventDefault();cn(TMK_IS_MOUSE_RESIZE);}function eb(e){e.preventDefault();cn(TMK_IS_TOUCH_RESIZE);}function ec(window_id){let x;let y;let obj;let func;let over;let rect;let new_x;let new_y;let min_w;let max_w;let min_h;let max_h;let coords;let content;let delta_x;let delta_y;let win;let window_width;let content_width;let window_height;let content_height;let header;let header_height;if(content=TMK_get_content_obj(window_id)){rect=content.getBoundingClientRect();content_width=rect.width;content_height=rect.height;}if(win=TMK_windows[window_id]){if(obj=TMK_get_window_obj(window_id)){x=eo["last_x"];y=eo["last_y"];min_w=win["min_w"];min_h=win["min_h"];max_w=win["max_w"];max_h=win["max_h"];if(header=TMK_get_header_obj(window_id)){rect=header.getBoundingClientRect();header_height=rect.height;}else header_height=0;rect=obj.getBoundingClientRect();if(eo["side"]==TMK_AXIS_TOP_LEFT){x      -=eo["dlx"];y      -=eo["dly"];delta_x=rect.left - x;delta_y=rect.top - y;if((content_width+delta_x)<=max_w &&(content_width+delta_x)> min_w){obj.style.left=x+"px";obj.style.width=(content_width+delta_x)+"px";content.style.width=(content_width+delta_x)+"px";}if((content_height+delta_y)<=max_h &&(content_height+delta_y)>=min_h){obj.style.top=y+"px";obj.style.height=(content_height+header_height+delta_y)+"px";content.style.height=(content_height+delta_y)+"px";}}else if(eo["side"]==TMK_AXIS_TOP){y      -=eo["dly"];delta_y=rect.top - y;if((content_height+delta_y)<=max_h &&(content_height+delta_y)>=min_h){obj.style.top=y+"px";obj.style.height=(content_height+header_height+delta_y)+"px";content.style.height=(content_height+delta_y)+"px";}}else if(eo["side"]==TMK_AXIS_TOP_RIGHT){y      -=eo["dly"];delta_x=x -(rect.left+rect.width)- eo["drx"];delta_y=rect.top - y;if((content_width+delta_x)<=max_w &&(content_width+delta_x)> min_w){obj.style.width=(content_width+delta_x)+"px";content.style.width=(content_width+delta_x)+"px";}if((content_height+delta_y)<=max_h &&(content_height+delta_y)>=min_h){obj.style.top=y+"px";obj.style.height=(content_height+header_height+delta_y)+"px";content.style.height=(content_height+delta_y)+"px";}}else if(eo["side"]==TMK_AXIS_RIGHT){delta_x=x -(rect.left+rect.width)- eo["drx"];if((content_width+delta_x)<=max_w &&(content_width+delta_x)> min_w){obj.style.width=(content_width+delta_x)+"px";content.style.width=(content_width+delta_x)+"px";}}else if(eo["side"]==TMK_AXIS_BOTTOM_RIGHT){delta_x=x -(rect.left+rect.width)- eo["drx"];delta_y=y -(rect.top+rect.height)- eo["dry"];if((content_width+delta_x)<=max_w &&(content_width+delta_x)> min_w){obj.style.width=(content_width+delta_x)+"px";content.style.width=(content_width+delta_x)+"px";}if((content_height+delta_y)<=max_h &&(content_height+delta_y)>=min_h){obj.style.height=(content_height+header_height+delta_y)+"px";content.style.height=(content_height+delta_y)+"px";}}else if(eo["side"]==TMK_AXIS_BOTTOM){delta_y=y -(rect.top+rect.height)- eo["dry"];if((content_height+delta_y)<=max_h &&(content_height+delta_y)>=min_h){obj.style.height=(content_height+header_height+delta_y)+"px";content.style.height=(content_height+delta_y)+"px";}}else if(eo["side"]==TMK_AXIS_BOTTOM_LEFT){x      -=eo["dlx"];delta_x=rect.left - x;delta_y=y -(rect.top+rect.height)- eo["dry"];if((content_width+delta_x)<=max_w &&(content_width+delta_x)> min_w){obj.style.left=x+"px";obj.style.width=(content_width+delta_x)+"px";content.style.width=(content_width+delta_x)+"px";}if((content_height+delta_y)<=max_h &&(content_height+delta_y)>=min_h){obj.style.height=(content_height+header_height+delta_y)+"px";content.style.height=(content_height+delta_y)+"px";}}else if(eo["side"]==TMK_AXIS_LEFT){x      -=eo["dlx"];delta_x=rect.left - x;if((content_width+delta_x)<=max_w &&(content_width+delta_x)> min_w){obj.style.left=x+"px";obj.style.width=(content_width+delta_x)+"px";content.style.width=(content_width+delta_x)+"px";}}rect=obj.getBoundingClientRect();win["x"]=rect.left;win["y"]=rect.top;win["w"]=rect.width;win["h"]=rect.height;if(func=win["onresize"]){coords=TMK_get_window_position(window_id);func(window_id,win["arg"],coords);}}}}function TMK_background(id,z_index,onclick){let background;background=document.createElement("div");background.style.position="fixed";background.style.top="0px";background.style.left="0px";background.style.width="100%";background.style.height="100%";background.style.display="block";background.id=id;background.onclick=onclick;background.ondblclick=onclick;background.oncontextmenu=onclick;background.style.zIndex=z_index.toString();return background;}function TMK_get_window_position(window_id){let ret;let win;ret={};if(win=TMK_windows[window_id]){ret={x:win["x"],y:win["y"],w:win["w"],h:win["h"],state:win["state"],};}return ret;}function TMK_set_window_position(window_id,coords){let obj;let val;let win;if(win=TMK_windows[window_id]){if(obj=TMK_get_window_obj(window_id)){if(!coords){coords={};coords["x"]=win["x"];coords["y"]=win["y"];coords["w"]=win["w"];coords["h"]=win["h"];}if(typeof(val=coords["x"])!="undefined"){win["x"]=val;obj.style.left=val+"px"};if(typeof(val=coords["y"])!="undefined"){win["y"]=val;obj.style.top=val+"px"};if(typeof(val=coords["w"])!="undefined"){win["w"]=val;obj.style.width=val+"px"};if(typeof(val=coords["h"])!="undefined"){win["h"]=val;obj.style.height=val+"px"};}}}function TMK_window_exists(window_id){return TMK_windows[window_id] ? true:false;}function TMK_toggle_maximize(window_id){let win;if(win=TMK_windows[window_id]){if(win["state"]=="open")TMK_window_maximize(window_id);else if(win["state"]=="fullsize")TMK_window_unmaximize(window_id);}}function TMK_window_maximize(window_id){let id;let ewb;let b_top;let b_bottom;let b_left;let b_right;let obj;let func;let wobj;let style;let header;let height;let content;let header_rect;let window_rect;let content_rect;let header_height;style=window.getComputedStyle(TMK_get_window_obj(window_id));b_top=parseInt(style.getPropertyValue("border-top-width").replace("px",""));b_bottom=parseInt(style.getPropertyValue("border-bottom-width").replace("px",""));b_left=parseInt(style.getPropertyValue("border-left-width").replace("px",""));b_right=parseInt(style.getPropertyValue("border-right-width").replace("px",""));if(content=TMK_get_content_obj(window_id)){cq(window_id);if(wobj=TMK_get_window_obj(window_id)){window_rect=wobj.getBoundingClientRect();if(header=TMK_get_header_obj(window_id)){header_rect=header.getBoundingClientRect();header_height=header_rect.height;header.style.borderTopLeftRadius="0px";header.style.borderTopRightRadius="0px";if(TMK_windows[window_id]["state"]=="open"){TMK_windows[window_id]["old_x"]=window_rect.left;TMK_windows[window_id]["x"]=0 - b_left;wobj.style.left=(0 - b_left)+"px";TMK_windows[window_id]["old_y"]=window_rect.top;TMK_windows[window_id]["y"]=0 - b_top;wobj.style.top=(0 - b_top)+"px";TMK_windows[window_id]["old_h"]=window_rect.height - header_height;TMK_windows[window_id]["h"]=er;wobj.style.height=er+"px";content.style.height=(er - header_height)+"px";TMK_windows[window_id]["old_w"]=window_rect.width;TMK_windows[window_id]["w"]=eq;wobj.style.width=(eq)+"px";content.style.width=(eq)+"px";TMK_windows[window_id]["state"]="fullsize";cr(window_id);if(func=TMK_windows[window_id]["onminimize"])func(window_id,TMK_windows[window_id]["arg"],TMK_WINDOW_UNMINIMIZE);}}TMK_window_raise(window_id);if(obj=document.getElementById(ey+window_id))obj.style.visibility="hidden";if(obj=document.getElementById(fa+window_id)){if(TMK_windows[window_id]["style"]=="win"){let html;html="<span>";html+="<span style=\"position:relative;right:-4px;top:-0px;\"><bold>&square;</bold></span>";html+="<span style=\"position:relative;right:4px;top:-3px;\">&square;</span>";html+="</span>";obj.innerHTML=html;}}}}}function TMK_window_unmaximize(window_id){let obj;let func;let wobj;let header;let height;let content;let header_rect;let window_rect;let content_rect;let header_height;if(content=TMK_get_content_obj(window_id)){if(wobj=TMK_get_window_obj(window_id)){cq(window_id);window_rect=wobj.getBoundingClientRect();if(header=TMK_get_header_obj(window_id)){header_rect=header.getBoundingClientRect();header_height=header_rect.height;header.style.borderTopLeftRadius=TMK_windows[window_id]["radius"]+"px";header.style.borderTopRightRadius=TMK_windows[window_id]["radius"]+"px";if(TMK_windows[window_id]["state"]=="fullsize"){let nsb;let ewb;let style;style=window.getComputedStyle(TMK_get_window_obj(window_id));nsb=parseInt(style.getPropertyValue("border-top-width").replace("px",""));nsb+=parseInt(style.getPropertyValue("border-bottom-width").replace("px",""));ewb=parseInt(style.getPropertyValue("border-left-width").replace("px",""));ewb+=parseInt(style.getPropertyValue("border-right-width").replace("px",""));TMK_windows[window_id]["x"]=TMK_windows[window_id]["old_x"];wobj.style.left=TMK_windows[window_id]["x"]+"px";delete TMK_windows[window_id]["old_x"];TMK_windows[window_id]["y"]=TMK_windows[window_id]["old_y"];wobj.style.top=TMK_windows[window_id]["y"]+"px";delete TMK_windows[window_id]["old_y"];TMK_windows[window_id]["w"]=TMK_windows[window_id]["old_w"];wobj.style.width=(TMK_windows[window_id]["w"] - ewb)+"px";content.style.width=(TMK_windows[window_id]["w"] - ewb)+"px";delete TMK_windows[window_id]["old_w"];TMK_windows[window_id]["h"]=TMK_windows[window_id]["old_h"];wobj.style.height=(TMK_windows[window_id]["h"]+header_height - nsb)+"px";content.style.height=(TMK_windows[window_id]["h"] - nsb)+"px";delete TMK_windows[window_id]["old_h"];TMK_windows[window_id]["state"]="open";cr(window_id);if(func=TMK_windows[window_id]["onminimize"])func(window_id,TMK_windows[window_id]["arg"],TMK_WINDOW_UNMINIMIZE);}}TMK_window_raise(window_id);if(obj=document.getElementById(ey+window_id))obj.style.visibility="visible";if(obj=document.getElementById(fa+window_id)){if(TMK_windows[window_id]["style"]=="win"){let html;html="<span style=\"position:relative;top:-2px;\">&square;</span>";obj.innerHTML=html;}}}}}function TMK_toggle_minimize(window_id){let ret;let win;if(win=TMK_windows[window_id]){if(win["state"]=="open"){TMK_window_minimize(window_id);ret=TMK_WINDOW_MINIMIZE;}else if(win["state"]=="closed"){TMK_window_unminimize(window_id);ret=TMK_WINDOW_UNMINIMIZE;}}return ret;}function TMK_window_minimize(window_id){let obj;let func;let wobj;let header;let content;let header_rect;let content_rect;let launchpad_id;let header_height;let content_height;if(content=TMK_get_content_obj(window_id)){if(wobj=TMK_get_window_obj(window_id)){if(header=TMK_get_header_obj(window_id)){header_rect=header.getBoundingClientRect();header_height=header_rect.height;if(TMK_windows[window_id]["state"]=="open"){TMK_windows[window_id]["state"]="closed";if(launchpad_id=TMK_windows[window_id]["launchpad"]){if(wobj=TMK_get_window_obj(window_id)){let foo;let launchpad;wobj.classList.remove("shrink");foo=wobj.offsetWidth;wobj.classList.add("shrink");if(launchpad=TMK_get_launchpad(launchpad_id)){let rect1;let rect2;rect1=TMK_get_window_obj(window_id).getBoundingClientRect();rect2=TMK_get_window_obj(TMK_windows[window_id]["icon"]).getBoundingClientRect();TMK_slide_div(window_id,rect1.left,rect1.top,rect2.left,rect2.top,0.30,false);setTimeout( function(){TMK_window_display(window_id,false);},280);}}}else{content_rect=content.getBoundingClientRect();content_height=content_rect.height;wobj.style.height=header_height+"px";content.dataset.display=content.style.display;content.style.display="none";TMK_windows[window_id]["height"]=content_height;TMK_windows[window_id]["h"]=content_height+header_height;cq(window_id);header.style.borderBottomRightRadius=TMK_windows[window_id]["radius"]+"px";header.style.borderBottomLeftRadius=TMK_windows[window_id]["radius"]+"px";}if(func=TMK_windows[window_id]["onminimize"])func(window_id,TMK_windows[window_id]["arg"],TMK_WINDOW_MINIMIZE);if(obj=document.getElementById(fa+window_id))obj.style.visibility="hidden";}}ee(window_id);}}}function TMK_move_shrink(window_id,iterations,count,dx,dy){let pos;if(count< iterations){pos=TMK_get_window_position(window_id);TMK_set_window_position(window_id,{x:pos["x"] -(dx / iterations),y:pos["y"] -(dy / iterations)});setTimeout(function(){TMK_move_shrink(window_id,10,count+1,dx,dy)},50);}}function TMK_window_unminimize(window_id){let obj;let func;let wobj;let header;let height;let content;let content_rect;let launchpad_id;if(content=TMK_get_content_obj(window_id)){if(wobj=TMK_get_window_obj(window_id)){if(header=TMK_get_header_obj(window_id)){if(TMK_windows[window_id]["state"]=="closed"){TMK_windows[window_id]["state"]="open";if(launchpad_id=TMK_windows[window_id]["launchpad"]){TMK_set_window_position(window_id);TMK_window_display(window_id,true);}else{let header_rect;let header_height;header_rect=header.getBoundingClientRect();header_height=header_rect.height;height=TMK_windows[window_id]["height"];content.style.display=content.dataset.display;wobj.style.height=(header_height+height)+"px";TMK_windows[window_id]["h"]=header_height+height;cr(window_id);header.style.borderBottomRightRadius=0+"px";header.style.borderBottomLeftRadius=0+"px";}if(func=TMK_windows[window_id]["onminimize"])func(window_id,TMK_windows[window_id]["arg"],TMK_WINDOW_UNMINIMIZE);}}bz(window_id,3);if(obj=document.getElementById(fa+window_id))obj.style.visibility="visible";}}}function TMK_smooth_close(window_id){let obj;if(obj=TMK_get_window_obj(window_id)){if(!TMK_pre_close(window_id)){obj.classList.add("fadeout");setTimeout(function(){ef(window_id)},280);}}}function TMK_window_close(window_id){if(!TMK_pre_close(window_id))ef(window_id);}function TMK_pre_close(window_id){let key;let obj;let ret;let win;let func;let coords;let cancel_close;ret=false;if(win=TMK_windows[window_id]){if(func=win["onclose"]){coords=TMK_get_window_position(window_id);ret=func(window_id,win["arg"],coords);}if(!ret){win["closed"]=true;ek(window_id);ee(window_id);}}return ret;}function ee(window_id){let i;let win;let last;let count;if(win=TMK_windows[window_id]){if(!win["inactive"]){if((count=ep.length)> 0){last=-1;for(i=0;i< count;i++){if(ep[i]==window_id || !TMK_windows[ep[i]]){ep.splice(i,1);i--;count--;}else{if(TMK_windows[ep[i]]["state"]=="open")last=i;}}if(last>=0)bz(ep[last],4);}}}}function ef(window_id){let obj;let win;if(win=TMK_windows[window_id]){if(obj=TMK_get_window_obj(window_id))obj.remove();if(obj=TMK_get_background_obj(window_id))obj.remove();delete TMK_windows[window_id];}}function TMK_get_window(window_id){return TMK_windows[window_id];}function TMK_get_window_obj(window_id){let id;let ret;ret=null;if(window_id){id=es+window_id;ret=document.getElementById(id);}return ret;}function TMK_get_header_obj(window_id){let id;let ret;ret=null;if(window_id){id=et+window_id;ret=document.getElementById(id);}return ret;}function TMK_get_content_obj(window_id){let id;let ret;ret=null;if(window_id){id=eu+window_id;ret=document.getElementById(id);}return ret;}function TMK_get_window_id(window_id){let ret;ret=null;if(window_id)ret=es+window_id;return ret;}function TMK_get_content_id(window_id){let ret;ret=null;if(window_id)ret=eu+window_id;return ret;}function TMK_get_background_obj(window_id){let id;let ret;ret=null;if(window_id){id=ev+window_id;ret=document.getElementById(id);}return ret;}function TMK_window_display(window_id,display){let wobj;if(wobj=TMK_get_window_obj(window_id))wobj.style.visibility=display ? "visible":"hidden";}function TMK_highest_zindex(){let key;let zindex;let top_zindex;top_zindex=zindex=0;for(key in TMK_windows){if((zindex=TMK_windows[key]["zindex"])> top_zindex)top_zindex=zindex;}return top_zindex;}function dup_args(args){let ret;let key;ret={};if(args){for(key in args)ret[key]=args[key];}return ret;}let fb={exclusive:"exclusive",selfish:"selfish",focus:"focus",center_on:"center_on",html:"html",keyboard:"keyboard",axis:"axis",bcolor:"bcolor",radius:"radius",zindex:"zindex",header:"header",style:"style",dragable:"dragable",resize:"resize",shadow:"shadow",noborder:"noborder",onmove:"onmove",onmoved:"onmoved",onresize:"onresize",onresized:"onresized",onclose:"onclose",onminimize:"onminimize",id:"id",autosave:"autosave",x:"x",y:"y",w:"w",h:"h",max_w:"max_w",min_h:"min_h",min_w:"min_w",max_h:"max_h",overflow:"overflow",bimage:"bimage",arg:"arg",display:"display",menu:"menu",fit:"fit",box:"box",type:"type",window_id:"window_id",launchpad:"launchpad",icon:"icon",parent:"parent",inactive:"inactive",activity:"activity",zebra:"zebra",};function TMK_make_window_args(user_args,overrides,defaults,custom_args,globals){let key;let ret;ret={};for(key in overrides)ret[key]=overrides[key];for(key in custom_args){if(typeof ret[key]==="undefined"){if(user_args && typeof user_args[key]!=="undefined")ret[key]=user_args[key];else if(defaults && typeof defaults[key]!=="undefined")ret[key]=defaults[key];else if(globals && typeof globals[key]!=="undefined")ret[key]=globals[key];}}for(key in fb){if(typeof ret[key]==="undefined"){if(user_args && typeof user_args[key]!=="undefined")ret[key]=user_args[key];else if(defaults && typeof defaults[key]!=="undefined")ret[key]=defaults[key];else if(globals && typeof globals[key]!=="undefined")ret[key]=globals[key];}}return ret;}function TMK_text_to_html(str){let ret;if(typeof str==="undefined" || str==null)return str;ret=String(str).replace(/&/g,'&amp;').replace(/\//g,'&#47;').replace(/"/g,'&quot;').replace(/ /g,'&nbsp;').replace(/'/g,'&#39;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/\n/g,"<br>");return ret;}function eg(r1,r2){let ret;let x1;let y1;let w1;let h1;let x2;let y2;let w2;let h2;x1=r1["x"];y1=r1["y"];w1=r1["w"];h1=r1["h"];x2=r2["x"];y2=r2["y"];w2=r2["w"];h2=r2["h"];ret=((eh(x1,x2,w2)&&((y1<=y2 &&((y1+h1)>(y2+h2)))|| eh(y1,y2,h2)|| eh(y1+h1,y2,h2)))||(eh(x1+w1,x2,w2)&&((y1<=y2 &&((y1+h1)>(y2+h2)))|| eh(y1,y2,h2)|| eh(y1+h1,y2,h2)))||(eh(x2,x1,w1)&&((y2<=y1 &&((y2+h2)>(y1+h1)))|| eh(y2,y1,h1)|| eh(y2+h2,y1,h1)))||(eh(x2+w2,x1,w1)&&((y2<=y1 &&((y2+h2)>(y1+h1)))|| eh(y2,y1,h1)|| eh(y2+h2,y1,h1)))||(eh(y1,y2,h2)&&((x1<=x2 &&((x1+w1)>(x2+w2)))|| eh(x1,x2,w2)|| eh(x1+w1,x2,w2)))||(eh(y1+h1,y2,h2)&&((x1<=x2 &&((x1+w1)>(x2+w2)))|| eh(x1,x2,w2)|| eh(x1+w1,x2,w2)))||(eh(y2,y1,h1)&&((x2<=x1 &&((x2+w2)>(x1+w1)))|| eh(x2,x1,w1)|| eh(x2+w2,x1,w1)))||(eh(y2+h2,y1,h1)&&((x2<=x1 &&((x2+w2)>(x1+w1)))|| eh(x2,x1,w1)|| eh(x2+w2,x1,w1))));return ret;}function TMK_rect_in_rect(small_rect,big_rect){let ret;ret=TMK_point_in_rect(small_rect["x"],small_rect["y"],big_rect)&& TMK_point_in_rect(small_rect["x"]+small_rect["w"],small_rect["y"],big_rect)&& TMK_point_in_rect(small_rect["x"],small_rect["y"]+small_rect["h"],big_rect)&& TMK_point_in_rect(small_rect["x"]+small_rect["w"],small_rect["y"]+small_rect["h"],big_rect);return ret;}function TMK_point_in_rect(x,y,r){let ret;ret=eh(x,r["x"],r["w"])&& eh(y,r["y"],r["h"]);return ret;}function eh(p1,p2,d){return(p1>=p2)&&(p1<(p2+d));}function TMK_make_random_id(){return parseInt((Math.random()* 256 * 256)).toString(16)+"-"+parseInt((Math.random()* 256 * 256)).toString(16);}function TMK_get_window_zindex(window_id){let ret;ret=0;if(TMK_windows[window_id])ret=TMK_windows[window_id]["zindex"];return ret;}function TMK_set_window_zindex(window_id,zindex){let ret;let win;let wobj;ret=0;if((win=TMK_windows[window_id])){if(wobj=TMK_get_window_obj(window_id)){ret=win["zindex"];wobj.style.zIndex=zindex.toString();win["zindex"]=zindex;}}return ret;}function TMK_auto_save(){window.onunload=function(){ej()};}function ej(){let key;for(key in TMK_windows)ek(key);}function ek(window_id){let coords;let id;if(TMK_windows[window_id]["autosave"] &&(id=TMK_windows[window_id]["id"])){coords=TMK_get_window_position(window_id);if(coords["state"]=="fullsize"){coords["x"]=TMK_windows[window_id]["old_x"];coords["y"]=TMK_windows[window_id]["old_y"];coords["w"]=TMK_windows[window_id]["old_w"];coords["h"]=TMK_windows[window_id]["old_h"];}el(ew+id,coords);}}function TMK_top_zindex(){let key;let zindex;let top_zindex;top_zindex=0;for(key in TMK_windows){if((zindex=TMK_windows[key]["zindex"])> top_zindex)top_zindex=zindex;}return top_zindex;}function TMK_set_private_window_arg(window_id,key,val){let win;if((win=TMK_windows[window_id]))win["private"][key]=val;}function TMK_get_private_window_arg(window_id,key){let win;if((win=TMK_windows[window_id]))return win["private"][key];}function TMK_get_window_type(window_id){let ret;ret=null;if(TMK_windows[window_id])ret=TMK_windows[window_id]["type"];return ret;}function el(key,val){localStorage.setItem(key,JSON.stringify(val));}function em(key){var ret;if(ret=localStorage.getItem(key))ret=JSON.parse(ret);return ret;}function en(key){localStorage.removeItem(key);}